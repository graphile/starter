#!/usr/bin/env bash
. ../.envvar

DATABASE_HOST='172.17.0.1'
export DATABASE_URL="postgres://$DATABASE_OWNER:$DATABASE_OWNER_PASSWORD@$DATABASE_HOST/${DATABASE_NAME}"
export AUTH_DATABASE_URL="postgres://${DATABASE_AUTHENTICATOR}:$DATABASE_AUTHENTICATOR_PASSWORD@$DATABASE_HOST/${DATABASE_NAME}"

docker run --rm -it --init -p 5678:5678 \
  -e DATABASE_VISITOR="$DATABASE_VISITOR" \
  -e GRAPHILE_LICENSE="$GRAPHILE_LICENSE" \
  -e SECRET="$SECRET" \
  -e JWT_SECRET="$JWT_SECRET" \
  -e DATABASE_URL="$DATABASE_URL" \
  -e AUTH_DATABASE_URL="$AUTH_DATABASE_URL" \
  -e GITHUB_KEY="$GITHUB_KEY" \
  -e GITHUB_SECRET="$GITHUB_SECRET" \
  $1
